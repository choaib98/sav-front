
<style>
    .split-screen-container {
        height: 100vh; /* Adjust the height as needed */
    }

    .right-drawer{
        width: 70%;
    }

    .left-drawer {
        width: 100%; /* Adjust the width to split the screen evenly */
    }


</style>


<div class="flex flex-col flex-auto min-w-0">

    <!-- Header -->
    <div class="flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between p-6 sm:py-8 sm:px-10 border-b bg-card dark:bg-transparent">
        <div class="flex-1 min-w-0">

            <!-- Title -->
            <div class="mt-2  ">
                <h2 class="text-3xl md:text-4xl font-extrabold tracking-tight leading-7 sm:leading-10 truncate ">
                    Controle des dossiers SAV
                </h2>
            </div>
        </div>
    </div>

    <!-- Main -->
    <div class="flex-auto p-6 sm:p-10 bg-white">




        <mat-drawer-container class="split-screen-container" #drawerContainer >

            <mat-drawer  class="right-drawer"
                         mode="side"
                         [opened]="false"


                          position="end" #drawer>



                <!--             Teeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeest !-->




                <div class=" flex-auto p-6 sm:p-10 bg-white" *ngFor="let client of demandeSav1.dossier.clients">

                    <button (click)="fermer()" class=""><mat-icon>close</mat-icon>
                    </button>
                    <fuse-card #expandableCard01="fuseCard" class="p-7 border-third-500 border-2 flex flex-col max-w-7xl w-full transform transition-all mt-4 " >


                        <div class="relative flex flex-col rounded-2xl    overflow-hidden bg-card  ease-in-out duration-150" >
                            <div class="flex flex-col flex-auto  p-8 ">



                                <div class="text-3xl font-semibold items-center text-center"    > <span class="text-third-500 font-semibold text-xl">Demande SAV N° : </span>{{demandeSav1.demandeSavId}}</div>


                                <div class="flex mt-7 text-lg" *ngFor="let client of demandeSav1.dossier.clients">

                                    <span class="text-third-500 font-semibold text-lg  w-1/3"> Dossier N° : <span class="font-semibold text-black"> {{demandeSav1.dossier.dossierId}}</span> </span>

                                        <span class="text-third-500 font-semibold w-1/2 " > Nom Client : <span class="font-semibold text-black"> {{client.nom}} {{client.prenom}} </span></span>
                                    <span class="text-third-500 font-semibold w-1/2"> Date de demande SAV : <span class="font-semibold text-black">{{demandeSav1.date}} </span> </span><br>



                              </div>




                                <div class="flex mt-7 text-lg">

                                    <span class="text-third-500 font-semibold  w-1/3" >  CIN Client : <span class="font-semibold text-black">{{demandeSav1.dossier.cin}} </span></span>


                                    <span class="text-third-500 font-semibold w-1/2 ">  Statut Demande : <span class="font-semibold text-black"> Demande initiée </span></span>
     <span class="text-third-500 font-semibold w-1/2 "></span>

                                </div>

                                <span class="flex  mt-7 text-lg" >
                            <span class="text-third-500 font-semibold">  Liste des documents à télécharger :</span>


                                <button class=" fuse-mat-button-small ml-10" mat-flat-button [color]="'warn'"
                                        (click)="expandableCard01.expanded = !expandableCard01.expanded;toogleVisiblity4()()"
                                >

                                 <mat-icon
                                     class="icon-size-5 transform transition-transform ease-in-out duration-150 rotate-0"

                                     [svgIcon]="'heroicons_solid:chevron-down'">
                                 </mat-icon>
                             </button>
                             <mat-checkbox
                                 class="mb-2 ml-20"
                                 [(ngModel)]="isConforme"

                                 (change)="conforme()"
                                 id="conf"

                                 [color]="'warn'">
                                 <span class="text-third-500 font-semibold w-1/2 ">    Conforme</span>
                         </mat-checkbox>
                         <mat-checkbox
                             class="mb-2 ml-10"
                             [color]="'warn'"
                             [(ngModel)]="isNotConforme"

                             id="notConf"

                             (change)="isNoConforme();getMotifsByOperation()"
                         >
                             <span class="text-third-500 font-semibold w-1/2 ">    Non Conforme </span>
                         </mat-checkbox>

                         </span>
                                <fuse-card class="p-7  flex flex-col max-w-3xl w-full transform transition-all mt-4  " *ngIf="isVisible4"
                                           #expandableCard02="fuseCard"
                                >
                                    <ng-container *ngFor="let demandeDoc of demandeSav1.demandeDocs">


                             <span class="flex   mt-1">
                                 <span class="text-third-500 font-semibold">  {{demandeDoc.libelle}} : </span> <button  class="ml-10" (click)="downloadPDF(demandeDoc.fileName)"><mat-icon svgIcon="heroicons_outline:printer"></mat-icon></button>

                             </span>




                                    </ng-container>

                                </fuse-card>
                            </div>

                        </div>


                        <fuse-card class="p-7 flex flex-col max-w-5xl w-full transform transition-all mt-4 " *ngIf="isConforme"
                                   #expandableCard03="fuseCard"
                        >

                            <div class="flex flex-col p-8 max-w-lg ">


                                <button class=" fuse-mat-button-small ml-10 w-60" mat-flat-button [color]="'warn'">Valider Dossier</button>


                            </div>


                        </fuse-card>

                        <fuse-card class="p-7 flex flex-col max-w-5xl w-full transform transition-all mt-4 " *ngIf="isNotConforme"
                                   #expandableCard04="fuseCard"
                        >






                            <div class="flex flex-col p-8 max-w-lg">

                                <mat-form-field class="fuse-mat-dense flex-auto">
                                    <mat-label>Motif de non Conformité</mat-label>
                                    <mat-select class="">
                                        <div *ngFor="let motif of motifs">
                                            <mat-option value="">{{motif.libelle}}</mat-option>
                                        </div>
                                    </mat-select>
                                </mat-form-field>

                            </div>

                            <button class=" fuse-mat-button-small ml-10 w-60" mat-flat-button [color]="'warn'">Rejeter Dossier</button>





                        </fuse-card>




</fuse-card>

                </div>








                <!--             Teeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeest !-->





            </mat-drawer>
            <mat-drawer-content class="left-drawer">
            <div class=" items-center mt-4 sm:mt-0 md:mt-4">



                        <!-- <div class="grid gap-8 sm:grid-flow-col xl:grid-flow-row" *ngFor="let tier of tiers"> -->




                            <div class="flex flex-row items-center space-x-5">

                                <div>
                                    <div class="text-lg font-medium tracking-tight leading-6 truncate font-bold text-2xl ">Liste des opérations SAV :

                                        <div class="hidden">

                                            {{operations[0].operationId}}</div>



                                        <ng-container  *ngFor="let operation of operations; let i = index;">

                                            <div class="grid grid-cols-2 gap-4 mt-7">
                                                <div class="flex flex-col">

                                                    <span class="text-third-500 font-normal text-lg">  {{operation.nomOperation}}
                                                        <button class=" fuse-mat-button-small ml-10" mat-flat-button [color]="'warn'"
                                                                (click)="toggleVisibility(operation.operationId);"
                                                        >
                                                        <!-- <span class="mr-1">Details</span> -->
                                                        <mat-icon
                                                            [matBadge]="operation.demandeSav.length"
                                                            class="icon-size-5 transform transition-transform ease-in-out duration-150 rotate-0"

                                                            [svgIcon]="'heroicons_solid:chevron-down'">
                                                        </mat-icon></button></span>







                                                   <!-- <mat-expansion-panel hideToggle >
                                                        <mat-expansion-panel-header>
                                                            <mat-panel-title (click)="toggleVisibility(operation.operationId);">
                                                                {{operation.nomOperation}}
                                                            </mat-panel-title>
                                                            <mat-panel-description>
                                                                This is a summary of the content
                                                            </mat-panel-description>
                                                        </mat-expansion-panel-header>
                                                        <ng-container [(ngModel)]="test" *ngIf="operation.operationId==test && isVis3" >
                                                            <ng-container *ngFor="let demandeSav of demandesSav">
                                                                <fuse-card class="p-7 flex flex-col max-w-5xl w-full transform transition-all mt-4 "

                                                                           [id]="operation.operationId">



                                                                    <div class="relative flex flex-col rounded-2xl border-2 border-third-500 shadow hover:shadow-lg overflow-hidden bg-card transition-shadow ease-in-out duration-150" >
                                                                        <div class="flex flex-col flex-auto  p-8 text-center">
                                                                            <div class="text-2xl font-semibold items-center"  > Demande SAV N° {{demandeSav.demandeSavId}} </div>

                                                                            <span class="flex   mt-4">
                                                                            Dossier N° :  {{demandeSav.dossier.dossierId}}

                                                                            </span>


                                                                        </div>
                                                                        <div class="flex items-center justify-center py-4 px-8 text-primary-500 dark:text-primary-400 bg-gray-50 dark:bg-transparent dark:border-t">
                                                                            <button
                                                                                class="flex items-center"
                                                                                (click)="toggleDrawer();getDemandeSavId(demandeSav.demandeSavId);"
                                                                            >
                                                                                <span class="absolute inset-0"></span>
                                                                                <span class="font-medium">Traiter dossier</span>
                                                                                <mat-icon
                                                                                    class="ml-2 icon-size-5 text-current"
                                                                                    [svgIcon]="'heroicons_solid:arrow-narrow-right'"></mat-icon>
                                                                            </button>
                                                                        </div>
                                                                    </div>

                                                                </fuse-card>



                                                            </ng-container>
                                                        </ng-container>
                                                    </mat-expansion-panel>-->



                                                        <fuse-card class="p-7 flex flex-col w-xl  transform transition-all "
                                                                   #expandableCard2="fuseCard" *ngIf="isVisible"
                                                        >
                                                            <ng-container [(ngModel)]="test" *ngIf="operation.operationId==test && isVis3" >
                                                                <ng-container *ngFor="let demandeSav of demandesSav">
                                                                <fuse-card class="p-7 flex flex-col w-xl w-max-150 transform transition-all  "

                                                                           [id]="operation.operationId">



                                                                    <div class="relative flex flex-col rounded-2xl border-2 border-third-500 shadow hover:shadow-lg overflow-hidden bg-card transition-shadow ease-in-out duration-150" >
                                                                        <div class="flex flex-col flex-auto  p-8 ">
                                                                            <div class="text-third-500 font-normal text-xs"  > <mat-icon svgIcon="heroicons_outline:bookmark"></mat-icon>Demande SAV N° : &nbsp;<span class="text-black font-semibold w-1/2 ">  {{demandeSav.demandeSavId}} </span></div>

                                                                            <div class="text-third-500 font-normal text-xs"  >     <span class="flex   mt-4">
                                                                                <mat-icon svgIcon="heroicons_outline:folder"></mat-icon>     Dossier N° : &nbsp; <span class="text-black font-semibold w-1/2 ">  {{demandeSav.dossier.dossierId}} </span>

                                                                            </span></div>
                                                                            <div class="flex items-center justify-center py-4 px-8 text-primary-500 dark:text-primary-400 bg-gray-50 dark:bg-transparent dark:border-t">
                                                                                <button

                                                                                    class="flex items-center text-warn-400 text-xs"
                                                                                    (click)="toggleDrawer();getDemandeSavId(demandeSav.demandeSavId);"
                                                                                >
                                                                                    <span class="absolute inset-0"></span>
                                                                                    <span class="text-lg">Traiter dossier</span>
                                                                                    <mat-icon
                                                                                        class="ml-2 icon-size-5 text-current"
                                                                                        [svgIcon]="'heroicons_solid:arrow-narrow-right'"></mat-icon>
                                                                                </button>
                                                                            </div>

                                                                        </div>

                                                                    </div>

                                                                </fuse-card>



                                                            </ng-container>
                                                            </ng-container>
                                                        </fuse-card>







                                                </div>

                                            </div>


                                        </ng-container>
         </div>


                                </div>
                            </div>


                       </div></mat-drawer-content>
        </mat-drawer-container>
            </div>


                       <!-- <fuse-card class="p-7 flex flex-col max-w-5xl w-full transform transition-all " *ngIf="isVisible"
                        #expandableCard02="fuseCard"
                           >



                            <div class="flex flex-row items-center space-x-5">

                                <div>
                                    <div class="text-lg font-medium tracking-tight leading-6 truncate font-bold text-2xl ">Liste des dossiers

                                        <button class="bg-third-500 fuse-mat-button-small ml-140" mat-flat-button [color]="'primary'"
                                        (click)="expandableCard02.expanded = !expandableCard02.expanded;toggleVisibility2();"
                                        >
                                         &lt;!&ndash; <span class="mr-1">Details</span> &ndash;&gt;
                                         <mat-icon
                                             class="icon-size-5 transform transition-transform ease-in-out duration-150 rotate-0"

                                             [svgIcon]="'heroicons_solid:chevron-down'">
                                         </mat-icon>
                                     </button>
         </div>
         <ng-container *ngIf="isVis3" >

            <fuse-card class="p-7 flex flex-col max-w-5xl w-full transform transition-all mt-4 " *ngFor="let demandeSav of demandesSav">



<div class="relative flex flex-col rounded-2xl border-2 border-third-500 shadow hover:shadow-lg overflow-hidden bg-card transition-shadow ease-in-out duration-150" >
<div class="flex flex-col flex-auto  p-8 text-center">
<div class="text-2xl font-semibold items-center"  > Demande SAV N° {{demandeSav.demandeSavId}} </div>

<span class="flex   mt-4">
    Dossier N° :  {{demandeSav.dossier.dossierId}}

 </span>

<span class="flex   mt-4">
   CIN Client : {{demandeSav.dossier.cin}}

</span>
 <span class="flex  mt-4 " *ngFor="let client of demandeSav.dossier.clients">
   Nom Client : {{client.nom}} {{client.prenom}}

</span>
<span class="flex  mt-4 " >
   Date de demande SAV : {{demandeSav.date}}

</span>

</div>
<div class="flex items-center justify-center py-4 px-8 text-primary-500 dark:text-primary-400 bg-gray-50 dark:bg-transparent dark:border-t">
<button
    class="flex items-center"
    (click)="getDemandeSavId(demandeSav.demandeSavId)">
    <span class="absolute inset-0"></span>
    <span class="font-medium">Traiter dossier</span>
    <mat-icon
        class="ml-2 icon-size-5 text-current"
        [svgIcon]="'heroicons_solid:arrow-narrow-right'"></mat-icon>
</button>
</div>
</div>

            </fuse-card>



            </ng-container>

                                </div>
                            </div>




                        </fuse-card>
                        -->













<!-- <style>
    table {
  width: 70%;
  margin-left: 50px;
  margin-top: 50px;
  margin-bottom: 50px;
  border: 1px solid black;
}

th.mat-sort-header-sorted {
  color: black;
}

th, td {
  padding: 15px;
  text-align: left;
  border-bottom: 1px solid #000;
}

</style> -->
